{"ast":null,"code":"import _objectSpread from\"/home/jesse/Desktop/Weather Project/maplecast/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useCallback}from'react';import'./App.css';import Header from'./components/Header';import WeatherPages from'./components/WeatherPages';import LocationInfo from'./components/LocationInfo';import LocationSearch from'./components/LocationSearch';import PageNavigation from'./components/PageNavigation';import WeatherAlerts from'./components/WeatherAlerts';import{getCurrentPosition,fetchWeatherData,isLocationInCanada}from'./utils/api';import{registerAlertBackgroundSync}from'./utils/alertUtils';import{getProvinceFromCoordinates}from'./utils/canadaLocations';import axios from'axios';// PWA Install Detection and Enhancement\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";let deferredPrompt=null;let installButtonShown=false;function App(){// eslint-disable-next-line no-unused-vars\nconst[coordinates,setCoordinates]=useState(null);const[weatherData,setWeatherData]=useState(null);const[isLoading,setIsLoading]=useState(true);const[error,setError]=useState(null);const[isInCanada,setIsInCanada]=useState(true);const[locationInfo,setLocationInfo]=useState({city:'',region:''});const[usingFallbackLocation,setUsingFallbackLocation]=useState(false);const[isDarkMode,setIsDarkMode]=useState(localStorage.getItem('darkMode')==='true'||window.matchMedia('(prefers-color-scheme: dark)').matches);// Add state to track if weather data has been loaded initially\nconst[initialLoadComplete,setInitialLoadComplete]=useState(false);const[notificationsEnabled,setNotificationsEnabled]=useState(false);const[showNotificationPrompt,setShowNotificationPrompt]=useState(false);const[searchTerm,setSearchTerm]=useState('');// Add state for current page\nconst[currentPage,setCurrentPage]=useState(0);// PWA Enhancement States\nconst[showInstallPrompt,setShowInstallPrompt]=useState(false);const[showUpdatePrompt,setShowUpdatePrompt]=useState(false);// Update body class and localStorage when dark mode changes\nuseEffect(()=>{if(isDarkMode){document.body.classList.add('dark-mode');}else{document.body.classList.remove('dark-mode');}localStorage.setItem('darkMode',isDarkMode);},[isDarkMode]);const toggleDarkMode=()=>{setIsDarkMode(!isDarkMode);};const toggleNotifications=()=>{if(notificationsEnabled){// Disable notifications\nsetNotificationsEnabled(false);localStorage.setItem('notificationsEnabled','false');}else{// Show prompt to enable notifications\nsetShowNotificationPrompt(true);}};// PWA Install Handler\nconst handleInstallClick=async()=>{if(!deferredPrompt)return;// Show the install prompt\ndeferredPrompt.prompt();// Wait for the user to respond to the prompt\nconst{outcome}=await deferredPrompt.userChoice;if(outcome==='accepted'){console.log('User accepted the install prompt');// Trigger haptic feedback\nif('vibrate'in navigator){navigator.vibrate([100,50,100]);}}else{console.log('User dismissed the install prompt');}// Clear the deferred prompt\ndeferredPrompt=null;setShowInstallPrompt(false);};// App Update Handler\nconst handleUpdateClick=()=>{// Reload the page to get the new version\nwindow.location.reload();};// Dismiss Install Prompt\nconst dismissInstallPrompt=()=>{setShowInstallPrompt(false);// Don't show again for 24 hours\nlocalStorage.setItem('installPromptDismissed',Date.now().toString());};// Dismiss Update Prompt\nconst dismissUpdatePrompt=()=>{setShowUpdatePrompt(false);};// Browser notifications\n// eslint-disable-next-line no-unused-vars\nconst checkNotificationPermission=useCallback(()=>{if(!('Notification'in window)){console.log('This browser does not support notifications');setNotificationsEnabled(false);return;}if(Notification.permission==='granted'){console.log('Notification permission already granted');setNotificationsEnabled(true);}else if(Notification.permission!=='denied'){// We need to ask for permission\nsetShowNotificationPrompt(true);}},[]);// eslint-disable-next-line no-unused-vars\nconst requestNotificationPermission=useCallback(async()=>{if(!('Notification'in window)){return;}try{const permission=await Notification.requestPermission();if(permission==='granted'){console.log('Notification permission granted');setNotificationsEnabled(true);}else{console.log('Notification permission denied');setNotificationsEnabled(false);}}catch(error){console.error('Error requesting notification permission:',error);}setShowNotificationPrompt(false);},[]);// Function to get location and weather data based on coordinates\nconst getLocationAndWeatherData=useCallback(async function(position){let cachedLocationInfo=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;console.log('Getting weather data for position:',position);try{setIsLoading(true);setError(null);setCoordinates(position);// Save position to localStorage\nlocalStorage.setItem('lastUsedLocation',JSON.stringify(position));// Check if location is in Canada\nconst inCanada=await isLocationInCanada(position.lat,position.lon);console.log('Is location in Canada:',inCanada);setIsInCanada(inCanada);// Use cached location info only if city is a real city name (not province name)\nconst hasValidCache=cachedLocationInfo&&cachedLocationInfo.city&&cachedLocationInfo.region&&cachedLocationInfo.city!=='Unknown Location'&&cachedLocationInfo.city!==cachedLocationInfo.region&&!cachedLocationInfo.city.includes('Unknown')&&!['Ontario','Quebec','British Columbia','Alberta','Manitoba','Saskatchewan','Nova Scotia','New Brunswick','Newfoundland','Prince Edward Island','Yukon','Northwest Territories','Nunavut'].includes(cachedLocationInfo.city);if(hasValidCache){console.log('Using cached location info, skipping reverse geocoding');setLocationInfo(cachedLocationInfo);}else{// Clear bad cache\nlocalStorage.removeItem('lastUsedLocationInfo');// Get province from coordinates as fallback\nconst provinceInfo=getProvinceFromCoordinates(position.lat,position.lon);let locationData={city:'',region:provinceInfo?provinceInfo.name:''};// Use Photon reverse geocoding (free, no API key, no rate limits)\nconsole.log('Getting city name from Photon...');try{var _response$data,_response$data$featur;const response=await axios.get(\"https://photon.komoot.io/reverse?lon=\".concat(position.lon,\"&lat=\").concat(position.lat,\"&limit=1\"),{timeout:8000});if(((_response$data=response.data)===null||_response$data===void 0?void 0:(_response$data$featur=_response$data.features)===null||_response$data$featur===void 0?void 0:_response$data$featur.length)>0){const props=response.data.features[0].properties;locationData={city:props.city||props.town||props.village||props.name||props.county||'',region:props.state||(provinceInfo?provinceInfo.name:'')};console.log('Location from Photon:',locationData);}}catch(error){console.log('Photon reverse geocoding failed:',error.message);}setLocationInfo(locationData);if(locationData.city){localStorage.setItem('lastUsedLocationInfo',JSON.stringify(locationData));}}// Get weather data\nconsole.log('Fetching weather data...');const data=await fetchWeatherData(position.lat,position.lon);console.log('Weather data received successfully');setWeatherData(data);// Set initialLoadComplete to true since we've loaded weather data\nconsole.log('Setting initialLoadComplete to true');setInitialLoadComplete(true);// Finally, set loading to false\nsetIsLoading(false);return true;// Success\n}catch(err){// Check if there's an issue with the API key\nconst isApiKeyIssue=err.message&&(err.message.includes('401')||err.message.includes('unauthorized')||err.message.includes('Unauthorized'));if(isApiKeyIssue){console.error('API Key issue detected:',err.message);setError('Weather data unavailable. Please check the API key configuration or try again later.');}else{console.error('Error fetching weather data:',err.message);setError('Failed to fetch weather data. Please try again later.');}// Ensure loading state is set to false even on error\nsetIsLoading(false);return false;// Failed\n}},[]);const handleUseMyLocation=useCallback(async()=>{try{setError(null);setUsingFallbackLocation(false);setIsLoading(true);// Get user's location with fallback mechanisms\nconsole.log('Getting current position...');const position=await getCurrentPosition();console.log('Current position retrieved:',position);// Set location info with province from coordinates FIRST\n// This ensures alerts use the correct province while we fetch the city name\nconst provinceInfo=getProvinceFromCoordinates(position.lat,position.lon);const tempLocationData={city:'',// Will be filled by Photon\nregion:provinceInfo?provinceInfo.name:''};console.log('Setting temporary location info from coordinates:',tempLocationData);setLocationInfo(tempLocationData);const success=await getLocationAndWeatherData(position);// Only explicitly set initialLoadComplete if not already set in getLocationAndWeatherData\nif(success&&!initialLoadComplete){console.log('Setting initialLoadComplete to true in handleUseMyLocation');setInitialLoadComplete(true);}}catch(locationError){console.error('Location error:',locationError);// Special handling for secure origin errors\nif(locationError.code==='INSECURE_ORIGIN'){setError(locationError.message);}else{setError('Unable to determine your location. Please try searching for a location instead.');}setUsingFallbackLocation(true);setIsLoading(false);}},[getLocationAndWeatherData,initialLoadComplete]);const handleLocationSelect=useCallback(async location=>{console.log('Location selected in App component:',location);try{setIsLoading(true);// Show loading state while fetching weather data\n// Set location info FIRST so alerts use correct region\nconst locationData={city:location.name,region:location.state||location.province||''};console.log('Setting location info BEFORE weather fetch:',locationData);setLocationInfo(locationData);localStorage.setItem('lastUsedLocationInfo',JSON.stringify(locationData));const position={lat:location.lat,lon:location.lon};// Pass the location data so getLocationAndWeatherData doesn't overwrite it\nconst success=await getLocationAndWeatherData(position,locationData);if(!success){console.warn('Failed to get weather data for location');}// No need to set initialLoadComplete here anymore, as it's handled in getLocationAndWeatherData\n}catch(error){console.error('Error handling location selection:',error);setError('Failed to load weather data for the selected location. Please try again.');setIsLoading(false);}},[getLocationAndWeatherData]);// Add a useEffect to load the last used location from localStorage\nuseEffect(()=>{const loadLastUsedLocation=async()=>{const savedLocation=localStorage.getItem('lastUsedLocation');const savedLocationInfo=localStorage.getItem('lastUsedLocationInfo');// Load cached location info FIRST (before making API calls)\nlet cachedLocationInfo=null;if(savedLocationInfo){try{const parsed=JSON.parse(savedLocationInfo);// Only use cached info if it has both city and region\nif(parsed&&parsed.city&&parsed.region){cachedLocationInfo=parsed;console.log('Using cached location info:',cachedLocationInfo);setLocationInfo(cachedLocationInfo);}else{console.log('Cached location info incomplete, will fetch fresh:',parsed);}}catch(error){console.error('Error parsing saved location info:',error);}}if(savedLocation){try{const position=JSON.parse(savedLocation);// Only load weather data if we have a valid position\nif(position&&position.lat&&position.lon){console.log('Loading weather data for last used location:',position);// Pass cached location info to avoid unnecessary reverse geocoding\nawait getLocationAndWeatherData(position,cachedLocationInfo);}}catch(error){console.error('Error parsing saved location:',error);}}else{// If no saved location, set loading to false\nsetIsLoading(false);}};loadLastUsedLocation();},[getLocationAndWeatherData]);// Handle visibility change (app coming from background)\nuseEffect(()=>{const handleVisibilityChange=()=>{if(document.visibilityState==='visible'){console.log('App became visible, checking location...');// Get current position and update if needed\nif('geolocation'in navigator){navigator.geolocation.getCurrentPosition(async position=>{const newPosition={lat:position.coords.latitude,lon:position.coords.longitude};// Check if location has changed significantly (more than 1km)\nconst hasLocationChanged=coordinates?calculateDistance(coordinates.lat,coordinates.lon,newPosition.lat,newPosition.lon)>1:true;if(hasLocationChanged){console.log('Location has changed, updating...');handleLocationSelect(newPosition);}},error=>{console.warn('Error getting current position:',error);},{enableHighAccuracy:true,timeout:10000,maximumAge:0});}}};// Add visibility change listener\ndocument.addEventListener('visibilitychange',handleVisibilityChange);// Clean up\nreturn()=>{document.removeEventListener('visibilitychange',handleVisibilityChange);};},[coordinates,handleLocationSelect]);// Helper function to calculate distance between two points using Haversine formula\nconst calculateDistance=(lat1,lon1,lat2,lon2)=>{const R=6371;// Earth's radius in km\nconst dLat=(lat2-lat1)*Math.PI/180;const dLon=(lon2-lon1)*Math.PI/180;const a=Math.sin(dLat/2)*Math.sin(dLat/2)+Math.cos(lat1*Math.PI/180)*Math.cos(lat2*Math.PI/180)*Math.sin(dLon/2)*Math.sin(dLon/2);const c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));return R*c;};// Enhanced PWA Install Experience\nuseEffect(()=>{const handleBeforeInstallPrompt=e=>{// Prevent the mini-infobar from appearing on mobile\ne.preventDefault();// Stash the event so it can be triggered later\ndeferredPrompt=e;// Show install banner if not already shown\nif(!installButtonShown){setShowInstallPrompt(true);installButtonShown=true;}};const handleAppInstalled=()=>{console.log('PWA installed successfully');setShowInstallPrompt(false);deferredPrompt=null;// Trigger haptic feedback if available\nif('vibrate'in navigator){navigator.vibrate([100,50,100]);}};// Listen for install prompt\nwindow.addEventListener('beforeinstallprompt',handleBeforeInstallPrompt);window.addEventListener('appinstalled',handleAppInstalled);return()=>{window.removeEventListener('beforeinstallprompt',handleBeforeInstallPrompt);window.removeEventListener('appinstalled',handleAppInstalled);};},[]);// Service Worker Update Handler\nuseEffect(()=>{const handleSWUpdate=event=>{if(event.data.type==='SW_UPDATED'){console.log('Service Worker updated:',event.data.version);setShowUpdatePrompt(true);// Trigger haptic feedback\nif('vibrate'in navigator){navigator.vibrate([50,30,50]);}}};const handleNewAlerts=event=>{if(event.data.type==='NEW_ALERTS'){console.log('New alerts received:',event.data.alerts);// Trigger haptic feedback for alerts\nif('vibrate'in navigator){navigator.vibrate([200,100,200]);}}};if('serviceWorker'in navigator){navigator.serviceWorker.addEventListener('message',handleSWUpdate);navigator.serviceWorker.addEventListener('message',handleNewAlerts);}return()=>{if('serviceWorker'in navigator){navigator.serviceWorker.removeEventListener('message',handleSWUpdate);navigator.serviceWorker.removeEventListener('message',handleNewAlerts);}};},[]);// Pull-to-Refresh functionality\nconst[pullToRefresh,setPullToRefresh]=useState(false);const[startY,setStartY]=useState(0);const[currentY,setCurrentY]=useState(0);const handleTouchStart=e=>{// Only enable pull-to-refresh at the top of the page\nif(window.scrollY===0){setStartY(e.touches[0].clientY);setPullToRefresh(true);}};const handleTouchMove=e=>{if(!pullToRefresh)return;const y=e.touches[0].clientY;setCurrentY(y);// Add visual feedback for pull distance\nconst pullDistance=y-startY;if(pullDistance>0&&pullDistance<150&&e.currentTarget&&e.currentTarget.style){e.currentTarget.style.transform=\"translateY(\".concat(pullDistance*0.5,\"px)\");}};const handleTouchEnd=async e=>{if(!pullToRefresh)return;const pullDistance=currentY-startY;// Safely reset transform if currentTarget exists\nif(e.currentTarget&&e.currentTarget.style){e.currentTarget.style.transform='translateY(0)';}if(pullDistance>80){// Trigger refresh\nif('vibrate'in navigator){navigator.vibrate(50);}setPullToRefresh(false);setCurrentY(0);setStartY(0);// Refresh weather data\nif(coordinates){await getLocationAndWeatherData(coordinates);}}else{// Reset position without refresh\nsetPullToRefresh(false);setCurrentY(0);setStartY(0);}};// Initialize the app (no API key needed for Environment Canada!)\nuseEffect(()=>{console.log('MapleCast Weather 3.0 initializing with enhanced PWA features...');// App is ready to search for locations even before getting current location\nsetIsLoading(false);// Add pull-to-refresh listeners\ndocument.addEventListener('touchstart',handleTouchStart,{passive:true});document.addEventListener('touchmove',handleTouchMove,{passive:true});document.addEventListener('touchend',handleTouchEnd);return()=>{document.removeEventListener('touchstart',handleTouchStart);document.removeEventListener('touchmove',handleTouchMove);document.removeEventListener('touchend',handleTouchEnd);};},[coordinates,getLocationAndWeatherData]);// IMPORTANT: Add a useEffect to mark initial loading state as complete and turn off loader\nuseEffect(()=>{// Set initial state to not loading if we haven't loaded weather yet\nif(!initialLoadComplete){setIsLoading(false);}},[initialLoadComplete]);// Add a useEffect to check notification permission on mount\nuseEffect(()=>{checkNotificationPermission();// Register for background sync for weather alerts\nif(notificationsEnabled){registerAlertBackgroundSync().then(success=>{console.log('Background sync registration:',success?'successful':'failed');});}// Clean up\nreturn()=>{if('serviceWorker'in navigator){navigator.serviceWorker.removeEventListener('message',()=>{});}};},[checkNotificationPermission,notificationsEnabled]);if(error&&!usingFallbackLocation){return/*#__PURE__*/_jsxs(\"div\",{className:\"app error-container \".concat(isDarkMode?'dark-mode':''),children:[/*#__PURE__*/_jsx(Header,{isDarkMode:isDarkMode,toggleDarkMode:toggleDarkMode}),/*#__PURE__*/_jsxs(\"div\",{className:\"error-message card\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fa-solid fa-triangle-exclamation\"}),\" Oops! Something went wrong\"]}),/*#__PURE__*/_jsx(\"p\",{children:error}),/*#__PURE__*/_jsxs(\"button\",{onClick:handleUseMyLocation,children:[/*#__PURE__*/_jsx(\"i\",{className:\"fa-solid fa-rotate\"}),\" Try Again\"]})]})]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"app\",children:[/*#__PURE__*/_jsx(Header,{toggleDarkMode:toggleDarkMode,isDarkMode:isDarkMode,toggleNotifications:toggleNotifications,notificationsEnabled:notificationsEnabled}),/*#__PURE__*/_jsxs(\"div\",{className:\"app-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"search-location-container\",children:[initialLoadComplete&&!isLoading&&/*#__PURE__*/_jsx(LocationInfo,{isInCanada:isInCanada,cityName:locationInfo.city,regionName:locationInfo.region}),/*#__PURE__*/_jsx(LocationSearch,{onLocationSelect:handleLocationSelect,onUseMyLocation:handleUseMyLocation,onSearchTermChange:setSearchTerm})]}),usingFallbackLocation&&/*#__PURE__*/_jsxs(\"div\",{className:\"warning-banner\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fa-solid fa-triangle-exclamation\"}),/*#__PURE__*/_jsx(\"p\",{children:error||\"Using estimated location. For precise location, try accessing via HTTPS or use the location search.\"})]}),initialLoadComplete&&!isLoading&&/*#__PURE__*/_jsx(WeatherAlerts,{locationInfo:_objectSpread(_objectSpread({},locationInfo),{},{lat:coordinates===null||coordinates===void 0?void 0:coordinates.lat,lon:coordinates===null||coordinates===void 0?void 0:coordinates.lon,name:locationInfo.city}),isInCanada:isInCanada,currentPage:currentPage,isSearching:isLoading||!!searchTerm&&!coordinates}),initialLoadComplete&&!isLoading&&/*#__PURE__*/_jsx(PageNavigation,{currentPage:currentPage,setCurrentPage:setCurrentPage,totalPages:4}),isLoading?/*#__PURE__*/_jsxs(\"div\",{className:\"loading-container card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"loading-spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading weather data...\"}),searchTerm&&/*#__PURE__*/_jsxs(\"p\",{className:\"loading-subtext\",children:[\"Searching for \\\"\",searchTerm,\"\\\"\"]}),!searchTerm&&coordinates&&/*#__PURE__*/_jsxs(\"p\",{className:\"loading-subtext\",children:[\"Getting data for coordinates: \",coordinates.lat.toFixed(2),\", \",coordinates.lon.toFixed(2)]})]}):/*#__PURE__*/_jsx(_Fragment,{children:!initialLoadComplete?/*#__PURE__*/_jsxs(\"div\",{className:\"welcome-container card\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Welcome to MapleCast Weather\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Click \\\"Use my location\\\" or search for a location to get started.\"}),/*#__PURE__*/_jsx(\"p\",{className:\"search-hint\",children:\"You can search directly for any location using the search bar above.\"})]}):/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(WeatherPages,{weatherData:weatherData,currentPage:currentPage,setCurrentPage:setCurrentPage,coordinates:coordinates,isDarkMode:isDarkMode})})})]}),/*#__PURE__*/_jsx(\"footer\",{className:\"footer\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"i\",{className:\"fa-solid fa-cloud\"}),\" Weather data provided by \",/*#__PURE__*/_jsx(\"a\",{href:\"https://open-meteo.com/\",target:\"_blank\",rel:\"noopener noreferrer\",children:\"Open-Meteo\"})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"footer-text\",children:[\"\\xA9 2026 MapleCast Weather |\",/*#__PURE__*/_jsx(\"a\",{href:\"https://github.com/screech24/maplecast-weather/blob/main/CHANGELOG.md\",target:\"_blank\",rel:\"noopener noreferrer\",className:\"version\",children:\"v2.3.0\"}),\" | Written with Claude Code Opus 4.5 - February 8, 2026\"]})]})}),showNotificationPrompt&&/*#__PURE__*/_jsx(\"div\",{className:\"notification-prompt\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"notification-prompt-content\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Stay Updated on Weather Alerts\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Enable notifications to receive alerts about severe weather conditions in your area, even when the app is closed.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"notification-prompt-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{requestNotificationPermission();setShowNotificationPrompt(false);localStorage.setItem('notificationPromptShown','true');},className:\"primary-button\",children:\"Enable Notifications\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowNotificationPrompt(false);localStorage.setItem('notificationPromptShown','true');},className:\"secondary-button\",children:\"Not Now\"})]})]})}),showInstallPrompt&&/*#__PURE__*/_jsx(\"div\",{className:\"pwa-install-prompt\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"pwa-install-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"pwa-install-icon\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa-solid fa-download\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"pwa-install-text\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Install MapleCast\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Get quick access to weather on your home screen\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"pwa-install-actions\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:handleInstallClick,className:\"install-button primary-button\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fa-solid fa-plus\"}),\"Install\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:dismissInstallPrompt,className:\"dismiss-button secondary-button\",children:\"Not Now\"})]})]})}),showUpdatePrompt&&/*#__PURE__*/_jsx(\"div\",{className:\"app-update-prompt\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"update-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"update-icon\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa-solid fa-arrow-rotate\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"update-text\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Update Available\"}),/*#__PURE__*/_jsx(\"p\",{children:\"A new version of MapleCast is ready to install\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"update-actions\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:handleUpdateClick,className:\"update-button primary-button\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"fa-solid fa-download\"}),\"Update Now\"]}),/*#__PURE__*/_jsx(\"button\",{onClick:dismissUpdatePrompt,className:\"dismiss-button secondary-button\",children:\"Later\"})]})]})}),pullToRefresh&&/*#__PURE__*/_jsxs(\"div\",{className:\"pull-to-refresh-indicator\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"refresh-icon\",children:/*#__PURE__*/_jsx(\"i\",{className:\"fa-solid fa-arrow-down\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"refresh-text\",children:currentY-startY>80?'Release to refresh':'Pull to refresh'})]})]});}export default App;","map":{"version":3,"names":["React","useState","useEffect","useCallback","Header","WeatherPages","LocationInfo","LocationSearch","PageNavigation","WeatherAlerts","getCurrentPosition","fetchWeatherData","isLocationInCanada","registerAlertBackgroundSync","getProvinceFromCoordinates","axios","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","deferredPrompt","installButtonShown","App","coordinates","setCoordinates","weatherData","setWeatherData","isLoading","setIsLoading","error","setError","isInCanada","setIsInCanada","locationInfo","setLocationInfo","city","region","usingFallbackLocation","setUsingFallbackLocation","isDarkMode","setIsDarkMode","localStorage","getItem","window","matchMedia","matches","initialLoadComplete","setInitialLoadComplete","notificationsEnabled","setNotificationsEnabled","showNotificationPrompt","setShowNotificationPrompt","searchTerm","setSearchTerm","currentPage","setCurrentPage","showInstallPrompt","setShowInstallPrompt","showUpdatePrompt","setShowUpdatePrompt","document","body","classList","add","remove","setItem","toggleDarkMode","toggleNotifications","handleInstallClick","prompt","outcome","userChoice","console","log","navigator","vibrate","handleUpdateClick","location","reload","dismissInstallPrompt","Date","now","toString","dismissUpdatePrompt","checkNotificationPermission","Notification","permission","requestNotificationPermission","requestPermission","getLocationAndWeatherData","position","cachedLocationInfo","arguments","length","undefined","JSON","stringify","inCanada","lat","lon","hasValidCache","includes","removeItem","provinceInfo","locationData","name","_response$data","_response$data$featur","response","get","concat","timeout","data","features","props","properties","town","village","county","state","message","err","isApiKeyIssue","handleUseMyLocation","tempLocationData","success","locationError","code","handleLocationSelect","province","warn","loadLastUsedLocation","savedLocation","savedLocationInfo","parsed","parse","handleVisibilityChange","visibilityState","geolocation","newPosition","coords","latitude","longitude","hasLocationChanged","calculateDistance","enableHighAccuracy","maximumAge","addEventListener","removeEventListener","lat1","lon1","lat2","lon2","R","dLat","Math","PI","dLon","a","sin","cos","c","atan2","sqrt","handleBeforeInstallPrompt","e","preventDefault","handleAppInstalled","handleSWUpdate","event","type","version","handleNewAlerts","alerts","serviceWorker","pullToRefresh","setPullToRefresh","startY","setStartY","currentY","setCurrentY","handleTouchStart","scrollY","touches","clientY","handleTouchMove","y","pullDistance","currentTarget","style","transform","handleTouchEnd","passive","then","className","children","onClick","cityName","regionName","onLocationSelect","onUseMyLocation","onSearchTermChange","_objectSpread","isSearching","totalPages","toFixed","href","target","rel"],"sources":["/home/jesse/Desktop/Weather Project/maplecast/src/App.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport './App.css';\nimport Header from './components/Header';\nimport WeatherPages from './components/WeatherPages';\nimport LocationInfo from './components/LocationInfo';\nimport LocationSearch from './components/LocationSearch';\nimport PageNavigation from './components/PageNavigation';\nimport WeatherAlerts from './components/WeatherAlerts';\nimport { getCurrentPosition, fetchWeatherData, isLocationInCanada } from './utils/api';\nimport { registerAlertBackgroundSync } from './utils/alertUtils';\nimport { getProvinceFromCoordinates } from './utils/canadaLocations';\nimport axios from 'axios';\n\n// PWA Install Detection and Enhancement\nlet deferredPrompt = null;\nlet installButtonShown = false;\n\nfunction App() {\n  // eslint-disable-next-line no-unused-vars\n  const [coordinates, setCoordinates] = useState(null);\n  const [weatherData, setWeatherData] = useState(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [isInCanada, setIsInCanada] = useState(true);\n  const [locationInfo, setLocationInfo] = useState({\n    city: '',\n    region: ''\n  });\n  const [usingFallbackLocation, setUsingFallbackLocation] = useState(false);\n  const [isDarkMode, setIsDarkMode] = useState(\n    localStorage.getItem('darkMode') === 'true' || \n    window.matchMedia('(prefers-color-scheme: dark)').matches\n  );\n  // Add state to track if weather data has been loaded initially\n  const [initialLoadComplete, setInitialLoadComplete] = useState(false);\n  const [notificationsEnabled, setNotificationsEnabled] = useState(false);\n  const [showNotificationPrompt, setShowNotificationPrompt] = useState(false);\n  const [searchTerm, setSearchTerm] = useState('');\n\n  // Add state for current page\n  const [currentPage, setCurrentPage] = useState(0);\n  \n  // PWA Enhancement States\n  const [showInstallPrompt, setShowInstallPrompt] = useState(false);\n  const [showUpdatePrompt, setShowUpdatePrompt] = useState(false);\n\n  // Update body class and localStorage when dark mode changes\n  useEffect(() => {\n    if (isDarkMode) {\n      document.body.classList.add('dark-mode');\n    } else {\n      document.body.classList.remove('dark-mode');\n    }\n    localStorage.setItem('darkMode', isDarkMode);\n  }, [isDarkMode]);\n\n  const toggleDarkMode = () => {\n    setIsDarkMode(!isDarkMode);\n  };\n\n  const toggleNotifications = () => {\n    if (notificationsEnabled) {\n      // Disable notifications\n      setNotificationsEnabled(false);\n      localStorage.setItem('notificationsEnabled', 'false');\n    } else {\n      // Show prompt to enable notifications\n      setShowNotificationPrompt(true);\n    }\n  };\n\n  // PWA Install Handler\n  const handleInstallClick = async () => {\n    if (!deferredPrompt) return;\n    \n    // Show the install prompt\n    deferredPrompt.prompt();\n    \n    // Wait for the user to respond to the prompt\n    const { outcome } = await deferredPrompt.userChoice;\n    \n    if (outcome === 'accepted') {\n      console.log('User accepted the install prompt');\n      // Trigger haptic feedback\n      if ('vibrate' in navigator) {\n        navigator.vibrate([100, 50, 100]);\n      }\n    } else {\n      console.log('User dismissed the install prompt');\n    }\n    \n    // Clear the deferred prompt\n    deferredPrompt = null;\n    setShowInstallPrompt(false);\n  };\n\n  // App Update Handler\n  const handleUpdateClick = () => {\n    // Reload the page to get the new version\n    window.location.reload();\n  };\n\n  // Dismiss Install Prompt\n  const dismissInstallPrompt = () => {\n    setShowInstallPrompt(false);\n    // Don't show again for 24 hours\n    localStorage.setItem('installPromptDismissed', Date.now().toString());\n  };\n\n  // Dismiss Update Prompt\n  const dismissUpdatePrompt = () => {\n    setShowUpdatePrompt(false);\n  };\n\n\n  // Browser notifications\n  // eslint-disable-next-line no-unused-vars\n  const checkNotificationPermission = useCallback(() => {\n    if (!('Notification' in window)) {\n      console.log('This browser does not support notifications');\n      setNotificationsEnabled(false);\n      return;\n    }\n    \n    if (Notification.permission === 'granted') {\n      console.log('Notification permission already granted');\n      setNotificationsEnabled(true);\n    } else if (Notification.permission !== 'denied') {\n      // We need to ask for permission\n      setShowNotificationPrompt(true);\n    }\n  }, []);\n  \n  // eslint-disable-next-line no-unused-vars\n  const requestNotificationPermission = useCallback(async () => {\n    if (!('Notification' in window)) {\n      return;\n    }\n    \n    try {\n      const permission = await Notification.requestPermission();\n      if (permission === 'granted') {\n        console.log('Notification permission granted');\n        setNotificationsEnabled(true);\n      } else {\n        console.log('Notification permission denied');\n        setNotificationsEnabled(false);\n      }\n    } catch (error) {\n      console.error('Error requesting notification permission:', error);\n    }\n    \n    setShowNotificationPrompt(false);\n  }, []);\n  \n\n  // Function to get location and weather data based on coordinates\n  const getLocationAndWeatherData = useCallback(async (position, cachedLocationInfo = null) => {\n    console.log('Getting weather data for position:', position);\n    try {\n      setIsLoading(true);\n      setError(null);\n      setCoordinates(position);\n\n      // Save position to localStorage\n      localStorage.setItem('lastUsedLocation', JSON.stringify(position));\n\n      // Check if location is in Canada\n      const inCanada = await isLocationInCanada(position.lat, position.lon);\n      console.log('Is location in Canada:', inCanada);\n      setIsInCanada(inCanada);\n\n      // Use cached location info only if city is a real city name (not province name)\n      const hasValidCache = cachedLocationInfo &&\n        cachedLocationInfo.city &&\n        cachedLocationInfo.region &&\n        cachedLocationInfo.city !== 'Unknown Location' &&\n        cachedLocationInfo.city !== cachedLocationInfo.region &&\n        !cachedLocationInfo.city.includes('Unknown') &&\n        !['Ontario', 'Quebec', 'British Columbia', 'Alberta', 'Manitoba', 'Saskatchewan',\n          'Nova Scotia', 'New Brunswick', 'Newfoundland', 'Prince Edward Island',\n          'Yukon', 'Northwest Territories', 'Nunavut'].includes(cachedLocationInfo.city);\n\n      if (hasValidCache) {\n        console.log('Using cached location info, skipping reverse geocoding');\n        setLocationInfo(cachedLocationInfo);\n      } else {\n        // Clear bad cache\n        localStorage.removeItem('lastUsedLocationInfo');\n        // Get province from coordinates as fallback\n        const provinceInfo = getProvinceFromCoordinates(position.lat, position.lon);\n        let locationData = {\n          city: '',\n          region: provinceInfo ? provinceInfo.name : ''\n        };\n\n        // Use Photon reverse geocoding (free, no API key, no rate limits)\n        console.log('Getting city name from Photon...');\n        try {\n          const response = await axios.get(\n            `https://photon.komoot.io/reverse?lon=${position.lon}&lat=${position.lat}&limit=1`,\n            { timeout: 8000 }\n          );\n\n          if (response.data?.features?.length > 0) {\n            const props = response.data.features[0].properties;\n            locationData = {\n              city: props.city || props.town || props.village || props.name || props.county || '',\n              region: props.state || (provinceInfo ? provinceInfo.name : '')\n            };\n            console.log('Location from Photon:', locationData);\n          }\n        } catch (error) {\n          console.log('Photon reverse geocoding failed:', error.message);\n        }\n\n        setLocationInfo(locationData);\n        if (locationData.city) {\n          localStorage.setItem('lastUsedLocationInfo', JSON.stringify(locationData));\n        }\n      }\n      \n      // Get weather data\n      console.log('Fetching weather data...');\n      const data = await fetchWeatherData(position.lat, position.lon);\n      console.log('Weather data received successfully');\n      setWeatherData(data);\n      \n      // Set initialLoadComplete to true since we've loaded weather data\n      console.log('Setting initialLoadComplete to true');\n      setInitialLoadComplete(true);\n      \n      // Finally, set loading to false\n      setIsLoading(false);\n      return true; // Success\n    } catch (err) {\n      // Check if there's an issue with the API key\n      const isApiKeyIssue = err.message && \n        (err.message.includes('401') || \n         err.message.includes('unauthorized') || \n         err.message.includes('Unauthorized'));\n      \n      if (isApiKeyIssue) {\n        console.error('API Key issue detected:', err.message);\n        setError('Weather data unavailable. Please check the API key configuration or try again later.');\n      } else {\n        console.error('Error fetching weather data:', err.message);\n        setError('Failed to fetch weather data. Please try again later.');\n      }\n      \n      // Ensure loading state is set to false even on error\n      setIsLoading(false);\n      return false; // Failed\n    }\n  }, []);\n\n  const handleUseMyLocation = useCallback(async () => {\n    try {\n      setError(null);\n      setUsingFallbackLocation(false);\n      setIsLoading(true);\n\n      // Get user's location with fallback mechanisms\n      console.log('Getting current position...');\n      const position = await getCurrentPosition();\n      console.log('Current position retrieved:', position);\n\n      // Set location info with province from coordinates FIRST\n      // This ensures alerts use the correct province while we fetch the city name\n      const provinceInfo = getProvinceFromCoordinates(position.lat, position.lon);\n      const tempLocationData = {\n        city: '', // Will be filled by Photon\n        region: provinceInfo ? provinceInfo.name : ''\n      };\n      console.log('Setting temporary location info from coordinates:', tempLocationData);\n      setLocationInfo(tempLocationData);\n\n      const success = await getLocationAndWeatherData(position);\n\n      // Only explicitly set initialLoadComplete if not already set in getLocationAndWeatherData\n      if (success && !initialLoadComplete) {\n        console.log('Setting initialLoadComplete to true in handleUseMyLocation');\n        setInitialLoadComplete(true);\n      }\n    } catch (locationError) {\n      console.error('Location error:', locationError);\n      \n      // Special handling for secure origin errors\n      if (locationError.code === 'INSECURE_ORIGIN') {\n        setError(locationError.message);\n      } else {\n        setError('Unable to determine your location. Please try searching for a location instead.');\n      }\n      \n      setUsingFallbackLocation(true);\n      setIsLoading(false);\n    }\n  }, [getLocationAndWeatherData, initialLoadComplete]);\n\n  const handleLocationSelect = useCallback(async (location) => {\n    console.log('Location selected in App component:', location);\n    try {\n      setIsLoading(true); // Show loading state while fetching weather data\n\n      // Set location info FIRST so alerts use correct region\n      const locationData = {\n        city: location.name,\n        region: location.state || location.province || ''\n      };\n      console.log('Setting location info BEFORE weather fetch:', locationData);\n      setLocationInfo(locationData);\n      localStorage.setItem('lastUsedLocationInfo', JSON.stringify(locationData));\n\n      const position = {\n        lat: location.lat,\n        lon: location.lon\n      };\n\n      // Pass the location data so getLocationAndWeatherData doesn't overwrite it\n      const success = await getLocationAndWeatherData(position, locationData);\n\n      if (!success) {\n        console.warn('Failed to get weather data for location');\n      }\n\n      // No need to set initialLoadComplete here anymore, as it's handled in getLocationAndWeatherData\n    } catch (error) {\n      console.error('Error handling location selection:', error);\n      setError('Failed to load weather data for the selected location. Please try again.');\n      setIsLoading(false);\n    }\n  }, [getLocationAndWeatherData]);\n\n  // Add a useEffect to load the last used location from localStorage\n  useEffect(() => {\n    const loadLastUsedLocation = async () => {\n      const savedLocation = localStorage.getItem('lastUsedLocation');\n      const savedLocationInfo = localStorage.getItem('lastUsedLocationInfo');\n\n      // Load cached location info FIRST (before making API calls)\n      let cachedLocationInfo = null;\n      if (savedLocationInfo) {\n        try {\n          const parsed = JSON.parse(savedLocationInfo);\n          // Only use cached info if it has both city and region\n          if (parsed && parsed.city && parsed.region) {\n            cachedLocationInfo = parsed;\n            console.log('Using cached location info:', cachedLocationInfo);\n            setLocationInfo(cachedLocationInfo);\n          } else {\n            console.log('Cached location info incomplete, will fetch fresh:', parsed);\n          }\n        } catch (error) {\n          console.error('Error parsing saved location info:', error);\n        }\n      }\n\n      if (savedLocation) {\n        try {\n          const position = JSON.parse(savedLocation);\n\n          // Only load weather data if we have a valid position\n          if (position && position.lat && position.lon) {\n            console.log('Loading weather data for last used location:', position);\n            // Pass cached location info to avoid unnecessary reverse geocoding\n            await getLocationAndWeatherData(position, cachedLocationInfo);\n          }\n        } catch (error) {\n          console.error('Error parsing saved location:', error);\n        }\n      } else {\n        // If no saved location, set loading to false\n        setIsLoading(false);\n      }\n    };\n\n    loadLastUsedLocation();\n  }, [getLocationAndWeatherData]);\n\n  // Handle visibility change (app coming from background)\n  useEffect(() => {\n    const handleVisibilityChange = () => {\n      if (document.visibilityState === 'visible') {\n        console.log('App became visible, checking location...');\n        // Get current position and update if needed\n        if ('geolocation' in navigator) {\n          navigator.geolocation.getCurrentPosition(\n            async (position) => {\n              const newPosition = {\n                lat: position.coords.latitude,\n                lon: position.coords.longitude\n              };\n              \n              // Check if location has changed significantly (more than 1km)\n              const hasLocationChanged = coordinates ? \n                calculateDistance(\n                  coordinates.lat, \n                  coordinates.lon, \n                  newPosition.lat, \n                  newPosition.lon\n                ) > 1 : true;\n              \n              if (hasLocationChanged) {\n                console.log('Location has changed, updating...');\n                handleLocationSelect(newPosition);\n              }\n            },\n            (error) => {\n              console.warn('Error getting current position:', error);\n            },\n            {\n              enableHighAccuracy: true,\n              timeout: 10000,\n              maximumAge: 0\n            }\n          );\n        }\n      }\n    };\n\n    // Add visibility change listener\n    document.addEventListener('visibilitychange', handleVisibilityChange);\n\n    // Clean up\n    return () => {\n      document.removeEventListener('visibilitychange', handleVisibilityChange);\n    };\n  }, [coordinates, handleLocationSelect]);\n\n  // Helper function to calculate distance between two points using Haversine formula\n  const calculateDistance = (lat1, lon1, lat2, lon2) => {\n    const R = 6371; // Earth's radius in km\n    const dLat = (lat2 - lat1) * Math.PI / 180;\n    const dLon = (lon2 - lon1) * Math.PI / 180;\n    const a = Math.sin(dLat/2) * Math.sin(dLat/2) +\n             Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *\n             Math.sin(dLon/2) * Math.sin(dLon/2);\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\n    return R * c;\n  };\n\n  // Enhanced PWA Install Experience\n  useEffect(() => {\n    const handleBeforeInstallPrompt = (e) => {\n      // Prevent the mini-infobar from appearing on mobile\n      e.preventDefault();\n      // Stash the event so it can be triggered later\n      deferredPrompt = e;\n      // Show install banner if not already shown\n      if (!installButtonShown) {\n        setShowInstallPrompt(true);\n        installButtonShown = true;\n      }\n    };\n\n    const handleAppInstalled = () => {\n      console.log('PWA installed successfully');\n      setShowInstallPrompt(false);\n      deferredPrompt = null;\n      // Trigger haptic feedback if available\n      if ('vibrate' in navigator) {\n        navigator.vibrate([100, 50, 100]);\n      }\n    };\n\n    // Listen for install prompt\n    window.addEventListener('beforeinstallprompt', handleBeforeInstallPrompt);\n    window.addEventListener('appinstalled', handleAppInstalled);\n\n    return () => {\n      window.removeEventListener('beforeinstallprompt', handleBeforeInstallPrompt);\n      window.removeEventListener('appinstalled', handleAppInstalled);\n    };\n  }, []);\n\n  // Service Worker Update Handler\n  useEffect(() => {\n    const handleSWUpdate = (event) => {\n      if (event.data.type === 'SW_UPDATED') {\n        console.log('Service Worker updated:', event.data.version);\n        setShowUpdatePrompt(true);\n        // Trigger haptic feedback\n        if ('vibrate' in navigator) {\n          navigator.vibrate([50, 30, 50]);\n        }\n      }\n    };\n\n    const handleNewAlerts = (event) => {\n      if (event.data.type === 'NEW_ALERTS') {\n        console.log('New alerts received:', event.data.alerts);\n        // Trigger haptic feedback for alerts\n        if ('vibrate' in navigator) {\n          navigator.vibrate([200, 100, 200]);\n        }\n      }\n    };\n\n    if ('serviceWorker' in navigator) {\n      navigator.serviceWorker.addEventListener('message', handleSWUpdate);\n      navigator.serviceWorker.addEventListener('message', handleNewAlerts);\n    }\n\n    return () => {\n      if ('serviceWorker' in navigator) {\n        navigator.serviceWorker.removeEventListener('message', handleSWUpdate);\n        navigator.serviceWorker.removeEventListener('message', handleNewAlerts);\n      }\n    };\n  }, []);\n\n  // Pull-to-Refresh functionality\n  const [pullToRefresh, setPullToRefresh] = useState(false);\n  const [startY, setStartY] = useState(0);\n  const [currentY, setCurrentY] = useState(0);\n\n  const handleTouchStart = (e) => {\n    // Only enable pull-to-refresh at the top of the page\n    if (window.scrollY === 0) {\n      setStartY(e.touches[0].clientY);\n      setPullToRefresh(true);\n    }\n  };\n\n  const handleTouchMove = (e) => {\n    if (!pullToRefresh) return;\n    \n    const y = e.touches[0].clientY;\n    setCurrentY(y);\n    \n    // Add visual feedback for pull distance\n    const pullDistance = y - startY;\n    if (pullDistance > 0 && pullDistance < 150 && e.currentTarget && e.currentTarget.style) {\n      e.currentTarget.style.transform = `translateY(${pullDistance * 0.5}px)`;\n    }\n  };\n\n  const handleTouchEnd = async (e) => {\n    if (!pullToRefresh) return;\n    \n    const pullDistance = currentY - startY;\n    \n    // Safely reset transform if currentTarget exists\n    if (e.currentTarget && e.currentTarget.style) {\n      e.currentTarget.style.transform = 'translateY(0)';\n    }\n    \n    if (pullDistance > 80) {\n      // Trigger refresh\n      if ('vibrate' in navigator) {\n        navigator.vibrate(50);\n      }\n      \n      setPullToRefresh(false);\n      setCurrentY(0);\n      setStartY(0);\n      \n      // Refresh weather data\n      if (coordinates) {\n        await getLocationAndWeatherData(coordinates);\n      }\n    } else {\n      // Reset position without refresh\n      setPullToRefresh(false);\n      setCurrentY(0);\n      setStartY(0);\n    }\n  };\n\n  // Initialize the app (no API key needed for Environment Canada!)\n  useEffect(() => {\n    console.log('MapleCast Weather 3.0 initializing with enhanced PWA features...');\n    // App is ready to search for locations even before getting current location\n    setIsLoading(false);\n    \n    // Add pull-to-refresh listeners\n    document.addEventListener('touchstart', handleTouchStart, { passive: true });\n    document.addEventListener('touchmove', handleTouchMove, { passive: true });\n    document.addEventListener('touchend', handleTouchEnd);\n    \n    return () => {\n      document.removeEventListener('touchstart', handleTouchStart);\n      document.removeEventListener('touchmove', handleTouchMove);\n      document.removeEventListener('touchend', handleTouchEnd);\n    };\n  }, [coordinates, getLocationAndWeatherData]);\n\n  // IMPORTANT: Add a useEffect to mark initial loading state as complete and turn off loader\n  useEffect(() => {\n    // Set initial state to not loading if we haven't loaded weather yet\n    if (!initialLoadComplete) {\n      setIsLoading(false);\n    }\n  }, [initialLoadComplete]);\n\n  // Add a useEffect to check notification permission on mount\n  useEffect(() => {\n    checkNotificationPermission();\n    \n    // Register for background sync for weather alerts\n    if (notificationsEnabled) {\n      registerAlertBackgroundSync().then(success => {\n        console.log('Background sync registration:', success ? 'successful' : 'failed');\n      });\n    }\n    \n    // Clean up\n    return () => {\n      if ('serviceWorker' in navigator) {\n        navigator.serviceWorker.removeEventListener('message', () => {});\n      }\n    };\n  }, [checkNotificationPermission, notificationsEnabled]);\n\n  if (error && !usingFallbackLocation) {\n    return (\n      <div className={`app error-container ${isDarkMode ? 'dark-mode' : ''}`}>\n        <Header \n          isDarkMode={isDarkMode} \n          toggleDarkMode={toggleDarkMode} \n        />\n        <div className=\"error-message card\">\n          <h2><i className=\"fa-solid fa-triangle-exclamation\"></i> Oops! Something went wrong</h2>\n          <p>{error}</p>\n          <button onClick={handleUseMyLocation}>\n            <i className=\"fa-solid fa-rotate\"></i> Try Again\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"app\">\n      <Header \n        toggleDarkMode={toggleDarkMode} \n        isDarkMode={isDarkMode} \n        toggleNotifications={toggleNotifications}\n        notificationsEnabled={notificationsEnabled}\n      />\n      \n      <div className=\"app-container\">\n        <div className=\"search-location-container\">\n          {initialLoadComplete && !isLoading && (\n            <LocationInfo \n              isInCanada={isInCanada} \n              cityName={locationInfo.city} \n              regionName={locationInfo.region} \n            />\n          )}\n          \n          <LocationSearch\n            onLocationSelect={handleLocationSelect}\n            onUseMyLocation={handleUseMyLocation}\n            onSearchTermChange={setSearchTerm}\n          />\n        </div>\n        \n        {usingFallbackLocation && (\n          <div className=\"warning-banner\">\n            <i className=\"fa-solid fa-triangle-exclamation\"></i>\n            <p>{error || \"Using estimated location. For precise location, try accessing via HTTPS or use the location search.\"}</p>\n          </div>\n        )}\n        \n        {/* Add WeatherAlerts component here */}\n        {initialLoadComplete && !isLoading && (\n          <WeatherAlerts \n            locationInfo={{\n              ...locationInfo,\n              lat: coordinates?.lat,\n              lon: coordinates?.lon,\n              name: locationInfo.city\n            }}\n            isInCanada={isInCanada}\n            currentPage={currentPage}\n            isSearching={isLoading || (!!searchTerm && !coordinates)}\n          />\n        )}\n        \n        {/* Add PageNavigation component here, only show when weather data is loaded */}\n        {initialLoadComplete && !isLoading && (\n          <PageNavigation \n            currentPage={currentPage} \n            setCurrentPage={setCurrentPage} \n            totalPages={4}\n          />\n        )}\n        \n        {isLoading ? (\n          <div className=\"loading-container card\">\n            <div className=\"loading-spinner\"></div>\n            <p>Loading weather data...</p>\n            {searchTerm && <p className=\"loading-subtext\">Searching for \"{searchTerm}\"</p>}\n            {!searchTerm && coordinates && <p className=\"loading-subtext\">Getting data for coordinates: {coordinates.lat.toFixed(2)}, {coordinates.lon.toFixed(2)}</p>}\n          </div>\n        ) : (\n          <>\n            {!initialLoadComplete ? (\n              <div className=\"welcome-container card\">\n                <h2>Welcome to MapleCast Weather</h2>\n                <p>Click \"Use my location\" or search for a location to get started.</p>\n                <p className=\"search-hint\">You can search directly for any location using the search bar above.</p>\n              </div>\n            ) : (\n              <>\n                <WeatherPages \n                  weatherData={weatherData} \n                  currentPage={currentPage}\n                  setCurrentPage={setCurrentPage}\n                  coordinates={coordinates}\n                  isDarkMode={isDarkMode}\n                />\n              </>\n            )}\n          </>\n        )}\n      </div>\n      \n      <footer className=\"footer\">\n        <div className=\"container\">\n          <p>\n            <i className=\"fa-solid fa-cloud\"></i> Weather data provided by <a href=\"https://open-meteo.com/\" target=\"_blank\" rel=\"noopener noreferrer\">Open-Meteo</a>\n          </p>\n          <p className=\"footer-text\">\n             2026 MapleCast Weather |\n            <a href=\"https://github.com/screech24/maplecast-weather/blob/main/CHANGELOG.md\"\n               target=\"_blank\"\n               rel=\"noopener noreferrer\"\n               className=\"version\">v2.3.0</a> |\n            Written with Claude Code Opus 4.5 - February 8, 2026\n          </p>\n        </div>\n      </footer>\n\n      {showNotificationPrompt && (\n        <div className=\"notification-prompt\">\n          <div className=\"notification-prompt-content\">\n            <h3>Stay Updated on Weather Alerts</h3>\n            <p>\n              Enable notifications to receive alerts about severe weather conditions in your area, \n              even when the app is closed.\n            </p>\n            <div className=\"notification-prompt-buttons\">\n              <button \n                onClick={() => {\n                  requestNotificationPermission();\n                  setShowNotificationPrompt(false);\n                  localStorage.setItem('notificationPromptShown', 'true');\n                }}\n                className=\"primary-button\"\n              >\n                Enable Notifications\n              </button>\n              <button \n                onClick={() => {\n                  setShowNotificationPrompt(false);\n                  localStorage.setItem('notificationPromptShown', 'true');\n                }}\n                className=\"secondary-button\"\n              >\n                Not Now\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* PWA Install Prompt */}\n      {showInstallPrompt && (\n        <div className=\"pwa-install-prompt\">\n          <div className=\"pwa-install-content\">\n            <div className=\"pwa-install-icon\">\n              <i className=\"fa-solid fa-download\"></i>\n            </div>\n            <div className=\"pwa-install-text\">\n              <h3>Install MapleCast</h3>\n              <p>Get quick access to weather on your home screen</p>\n            </div>\n            <div className=\"pwa-install-actions\">\n              <button \n                onClick={handleInstallClick}\n                className=\"install-button primary-button\"\n              >\n                <i className=\"fa-solid fa-plus\"></i>\n                Install\n              </button>\n              <button \n                onClick={dismissInstallPrompt}\n                className=\"dismiss-button secondary-button\"\n              >\n                Not Now\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* App Update Prompt */}\n      {showUpdatePrompt && (\n        <div className=\"app-update-prompt\">\n          <div className=\"update-content\">\n            <div className=\"update-icon\">\n              <i className=\"fa-solid fa-arrow-rotate\"></i>\n            </div>\n            <div className=\"update-text\">\n              <h3>Update Available</h3>\n              <p>A new version of MapleCast is ready to install</p>\n            </div>\n            <div className=\"update-actions\">\n              <button \n                onClick={handleUpdateClick}\n                className=\"update-button primary-button\"\n              >\n                <i className=\"fa-solid fa-download\"></i>\n                Update Now\n              </button>\n              <button \n                onClick={dismissUpdatePrompt}\n                className=\"dismiss-button secondary-button\"\n              >\n                Later\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Pull-to-Refresh Indicator */}\n      {pullToRefresh && (\n        <div className=\"pull-to-refresh-indicator\">\n          <div className=\"refresh-icon\">\n            <i className=\"fa-solid fa-arrow-down\"></i>\n          </div>\n          <div className=\"refresh-text\">\n            {currentY - startY > 80 ? 'Release to refresh' : 'Pull to refresh'}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}